SELECT
    COALESCE(SUM(
        CAST(s.amount AS DOUBLE) / POWER(10, t.decimals) * p.price
    ), 0) AS supply_usd_7d
FROM aave_v3_ethereum.Pool_evt_Supply s
LEFT JOIN tokens.erc20 t
    ON t.blockchain = 'ethereum'
    AND t.contract_address = s.reserve
LEFT JOIN prices.day p
    ON p.blockchain = 'ethereum'
    AND p.contract_address = s.reserve
    AND p.timestamp = DATE_TRUNC('day', s.evt_block_time)
WHERE s.evt_block_time >= NOW() - INTERVAL '7' DAY