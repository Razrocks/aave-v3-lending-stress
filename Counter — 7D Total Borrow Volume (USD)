SELECT
    COALESCE(SUM(
        CAST(b.amount AS DOUBLE) / POWER(10, t.decimals) * p.price
    ), 0) AS borrow_usd_7d
FROM aave_v3_ethereum.Pool_evt_Borrow b
LEFT JOIN tokens.erc20 t
    ON t.blockchain = 'ethereum'
    AND t.contract_address = b.reserve
LEFT JOIN prices.day p
    ON p.blockchain = 'ethereum'
    AND p.contract_address = b.reserve
    AND p.timestamp = DATE_TRUNC('day', b.evt_block_time)
WHERE b.evt_block_time >= NOW() - INTERVAL '7' DAY